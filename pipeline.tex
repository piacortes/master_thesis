\chapter{Aperture photometry pipeline}\label{chap:pipeline}

Since the beginning of the TraMoS project, an aperture photometry pipeline has been in development, on which several graduate and undergraduates students worked and are currently working on it. This pipeline is Python-based and includes standard procedures of reduction, calibrations and aperture photometry, including bias and flat field corrections. The user needs to give the coordinates of the target and reference stars and a range of pixels for a possible aperture. Then, in order to produce high-precision light curves of the target and reference stars, the pipeline semi-automatic finds the best aperture and ring size, for the sky that produces the less RMS in the light curves. 

The pipeline works with a specific directories' structure where all the needed information should be:
\begin{itemize}
\item raw: Folder containing the raw data of the observations. It could be fits files or compressed fits (e.g \textit{fit.ZIP}.
\item calib: This folder should include the flats -- sky or dome -- and bias files.
\item data: Empty folder which will contain the output data after the aperture photometry procedure.
\item figures: Empty folder on which all the figures generated in the reduction process will be store.
\item log: Folder containing the Python script to run the pipeline for the specific data set.
\item extraction.tex: Latex file which generates the PDF file with all the important information related to the aperture photometry procedure process, such as images of the stamps, radial profile of the target star, FWHM plots, preview of the light curve, etc.
\item tramos\_custom.sty: Customizable file containing the information related to the telescope, target's name, filter, date of the observation, RA, DEC and target's magnitude. When the pipeline finishes, it fills this file with the best aperture size obtained.
\end{itemize}

I have implemented dictionaries to ease the use of the pipeline with different telescopes. One of the biggest problems that I faced when I started reducing data, was the distinctness between the headers produced from different telescopes. For exmaple, while some of them recorded the type of filter as \textit{FILTER}, other use could use \textit{FILTERB}. Also, as the TraMoS project has been collecting data since more than 10 year ago, some of our used telescopes were updated with new CCDs, producing that the pipeline were not longer functional. Currently, the pipeline works with data from the following telescopes: 
\begin{itemize}
\item La Silla Observatory: Danish 1.54 m (previous and after 2017) and REM.
\item Cerro Tololo Inter-American Observatory: SMARTS 0.9 m and 1 m.
\item Las Campanas Observatory: Warsaw, Swope, Du Pont.
\item Cerro Pach√≥n: SOAR
\end{itemize}

In the sections ahead, I present the scripts for performing aperture photometry with the TraMoS pipeline of the targets studied in this thesis, following with an example of the PDF generated by the pipeline, containing all the relevant information of the procedure.

\section{Reduction script of WASP-18, WASP-19 and WASP-77A}



\section{Example of } 